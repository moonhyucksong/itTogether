<div  ng-controller="toggleToMapCtrl as toMapCtrl">
    <div ng-switch="subview">
        <div ng-switch-when="main_html"><div ng-include="'templates/main.html'"></div></div>
        <div ng-switch-when="map_html"><div ng-include="'templates/main_map.html'"></div></div>
    </div>
  </div>
  
  <div class="col-md-8" id='left-section'>
    <div id="left-feed-title">친구들의 활동</div>
    <div id='left-feed' ng-controller="friendFeedCtrl as ffCtrl">
      <div ng-repeat="feed in ffCtrl.feeds">
        <div class="test">
          <div class='row'>
            <div class='col-md-1'></div>
            <div class='col-md-10'>
              <div class="friend-panel">
                <div class="panel-heading" id='category-color-{{feed.category}}'></div>
                <div class='row'>
                  <div class="panel-body">
                    <div class="col-md-1"></div>
                    <div class="col-md-3">
                      <div class="img-div">
                        <span id="img-in-box"> <img
									src='{{feed.profilePicture}}' id='friend-profileImg'
									class="img-circle"></span>
							</div>
							</div>
           <a href="#detailModal" data-toggle="modal" data-fno="{{feed.fno}}" class="detail-view">
							<div class="col-md-6">
							<div class="content-div">
								<p id="user-name">{{feed.name}}</p>
								<h5 id="feed-info">
									<small class="text-muted"><img
										src="images/icons/calendar.png"> {{feed.dday}} </small> <small
										class="text-muted"><img
										src="images/icons/multiple.png">
										{{feed.stuffCount}}/{{feed.maxHeadCount}} </small> <small
										class="text-muted"><img src="images/icons/time.png">
										{{feed.createDate}}</small>
								</h5>
								<hr>
      
								<div id="unfriend-content">{{feed.title}}</div>
		          
							</div>
							</div>
		          </a>
							<div class="col-md-2"></div>
						</div>
					</div>
				</div>
				</div>
				<div class='col-md-1'></div>
				</div>
				</div>
			</div>
			</div>
		</div>

	<div class="col-md-4" id='right-section'>
			<div id="right-feed-title">주변 회원들의 활동</div>
			<div id='right-feed' ng-controller="noneFriendFeedCtrl as nffCtrl">
				<div ng-repeat="nfeed in nffCtrl.nfeeds">
				<div class="test">
						<div class="nonfriend-panel">
						<div class="panel-heading" id='category-color-{{nfeed.category}}'></div>
						<div class='row'>
						<div class="panel-body">
							<div class="col-md-3">
							<div class="img-div">
								<span id="img-in-box"> <img
									src='{{nfeed.profilePicture}}' id='nonfriend-profileImg'
									class="img-circle">
							</div>
							</div>
							<div class="col-md-9">
							<div class="content-div">
								<p id="user-name">{{nfeed.name}}</p>
								<h5 id="feed-info">
									<small class="text-muted"><img
										src="images/icons/calendar.png"> {{nfeed.dday}} </small> <small
										class="text-muted"><img
										src="images/icons/multiple.png">
										{{nfeed.stuffCount}}/{{nfeed.maxHeadCount}} </small> <small
										class="text-muted"><img src="images/icons/time.png">
										{{nfeed.createDate}}</small>
								</h5>
								<hr>
								<div id="unfriend-content">{{nfeed.content}}</div>
							</div>
							</div>
						</div>
					</div>
				</div>
				</div>
				</div>
			</div>
			</div>
		</div>
      

<!-- modal start -->
<div id="detailModal" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
      
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h5 class="modal-title" id="detail-title"></h5>
        <input type="hidden" id="detail-number">
        <input type="hidden" id="detail-category">
      </div>
      
      <div class="modal-body">
        
        <form role="form">
          
          <div class="form-group detail-detail">
            <div class="form-group">
              <img src="images/icons/calendar.png">
              <span id="detail-mTime"></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>
              <img src="images/icons/multiple.png">
              <span id="detail-stuffCount"></span><span>/</span><span id="detail-headCnt"></span>
              <span>&nbsp;&nbsp;&nbsp;</span>
              <img src="images/icons/time.png">
              <span id="detail-createDate"></span>
              <button type="button" class="btn btn-info btn-xs detail-btn" id="join-btn">참여하기</button>
            </div>
            <div class="form-group">
              <div class="detail-content" id="detail-content"></div>
            </div>
          </div>
          
          
          
          <div class="detail-user-info">
            <div class="detail-profile-img-div"><img class="img-circle detail-profile-img" src="" id="detail-profilePicture"></div>
            <div class="detail-user-name">
              <div class="detail-user-name-middle"><span id="detail-name"></span><span>&nbsp;님</span></div>
              <div class="detail-user-nickname-middle">
            <span>(</span><span id="detail-nickname"></span><span>)</span></div>
              </div>
          </div>
          
        </form>
        
      </div>
      
      <div class="modal-footer">
          <img src="images/default-img.png" class="dtail-default-img1">
          <img src="images/default-img.png" class="dtail-default-img2">
          <img src="images/default-img.png" class="dtail-default-img3">
      </div>
      
      </div>
      <!-- /.modal-content -->
    <!-- /.modal-dialog -->
  </div>
  <!-- /.modal -->
</div>
      
<script type="text/javascript">
   $(document).on('click', '.detail-view', function (e) {
    getFno = $(this).attr('data-fno');
     $.getJSON(contextRoot + '/feed/detail.do', 
        {
          fno: getFno    
        }, function(result) {
        //계속 쭉 해라 나머지 데이터들  
       $('#detail-number').val(result.detail.fno);
       $('#detail-title').text(result.detail.title);
       $('#detail-profilePicture').attr('src', result.detail.profilePicture);
       $('#detail-nickname').text(result.detail.nickname);
       $('#detail-name').text(result.detail.name);
       $('#detail-content').text(result.detail.content);
       $('#detail-mTime').text(result.detail.meetTime);
       $('#detail-headCnt').text(result.detail.currentCount + "/" + result.detail.maxHeadCount);
       $('#detail-createDate').text(result.detail.createDate);
       $('#detail-stuffCount').text(result.detail.stuffCount);
       $('#detail-category').val(result.detail.category);
       
       // 모달 창에서 카테고리에 따라 modal-header 색깔 바꿔주는 if문
       if ($('#detail-category').val() == '1') {
          removeDetailClass()
          $('.modal-header').addClass('detail-header-1');
        } else if ($('#detail-category').val() == '2') {
          removeDetailClass()
          $('.modal-header').addClass('detail-header-2');
        } else {
          removeDetailClass()
          $('.modal-header').addClass('detail-header-3');
        }
       // 모달 창에서 카테고리에 따른 클래스 삭제해주는 함수 
      function removeDetailClass() {
        $('.modal-header').removeClass('detail-header-1 detail-header-2 detail-header-3');
      } 
     });
     
        
   });
  

    
  
  $('#join-btn').on('click', function() {
      console.log(sessionStorage.getItem('mno'));
    $.ajax('feed/friendjoin.do', {
        method: 'get',
        dataType: 'json',
        data : {
              mno: sessionStorage.getItem('mno'),
              fno:  $('#detail-number').val()
              },
        success: function(result) {
            if ( result.data === 'success' ) {
                alert('참여 성공');
              } 
          }
      });
    });
  
</script>