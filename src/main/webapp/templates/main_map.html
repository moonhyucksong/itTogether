<link rel='stylesheet' href="css/main_map.css" />
<div id="mainMap" onmousedown="return false"> 
</div>
<!-- infoModal에 있는 구글맵 id가 map이라 mainMap으로 명명-->

<div id="finder-box">
  <div class="radius-control">
    <div class="btn-group" data-toggle="buttons">
      <label class="btn btn-info btn-xs radius-500">
        <input type="radio" name="options" id="option500" value="500">500m</label>
      <label class="btn btn-info btn-xs radius-1000 active">
        <input type="radio" name="options" id="option1000" value="1000" checked>&nbsp;1km</label>     
      <label class="btn btn-info btn-xs radius-2000">
        <input type="radio" name="options" id="option2000" value="2000">2km</label>
    </div>
  </div>
  
  <div class="btn-group" data-toggle="buttons">
    <label class="btn btn-info btn-sm btn-manwoman radius-control1 active">
      <input type="radio" name="options" id="optionManWoman" autocomplete="off" checked><img src="images/icons/manwoman.png"></label>
    <label class="btn btn-info btn-sm btn-man radius-control1">
      <input type="radio" name="options" id="optionMan" autocomplete="off"><img src="images/icons/man.png"></label>
    <label class="btn btn-info btn-sm btn-woman radius-control1">
      <input type="radio" name="options" id="optionWoman" autocomplete="off"><img src="images/icons/woman.png"></label>
  </div>
  <br>
  <div class="btn-group" data-toggle="buttons">
    <label class="btn btn-info btn-sm btn-age radius-control2 btn-selected">
      <input type="checkbox" autocomplete="off">나이</label>
    <label class="btn btn-info btn-sm btn-hobby radius-control2">
      <input type="checkbox" autocomplete="off">취미</label>
    <label class="btn btn-info btn-sm btn-hometown btnHometown radius-control2">
      <input type="checkbox" autocomplete="off">고향</label>
  </div>
</div>

<div id="friend-box" class="hide-scroll-on-mainMap" onmousedown="return false">
  <div class="viewport-on-mainMap">
    <div class="panel">
      <div class="panel-heading map-friend-panel">
        <h3 class="panel-title panel-friend-title">친구 추천</h3>
      </div>
      <div class="panel-body-for-scroll">
        <div class="panel-body panel-member">
      </div>
    </div>
  </div>
</div>
</div>

<!-- modal start -->
<div id="addfriendModal" class="modal fade">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header modal-header-bgcolor">
        <h5 class="modal-title addfriend-modal-title"></h5>
      </div>
      <div class="modal-body addfriend-modal-body">
        <div class="addfriend-modal-body2">
        </div>
      </div>
<!--
      <div class="modal-footer">
      </div>
-->
      <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
  </div>
  <!-- /.modal -->
</div>

<!-- modal start -->
<div id="untouchButtonModal" class="modal fade">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header modal-header-bgcolor">
        <h3 class="modal-title addfriend-modal-title untouch-modal-title">알림!</h3>
      </div>
      <div class="modal-body addfriend-modal-body">
        <div class="untouch-modal-body">
          <div>조건 검색을 하시려면 </div>
          <div>회원님의 정보를 모두 입력해주세요</div>
        </div>
      </div>
<!--
      <div class="modal-footer">
      </div>
-->
      <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
  </div>
  <!-- /.modal -->
</div>

<script>
  // json형식으로 받아온 나의 위치 데이터를 받아옴
  var myNickname, myIntro, myPhoto, myHobby, myHometown;
  var myLoc = [];
  var friendLocArr = [];  var notFriendLocArr = [];
  var distant = 1000;  //  거리 설정의 단위 변수 200m, 500m, 1km
  var sex = 0;  var age = 0;  var ageMin = 0;  var ageMax = 0;  
  var myRealHobby    = 0;  var myHobbyC    = 0;  
  var myRealHometown = 0;  var myHometownC = 0;
  var buttonTypes  = [];  var buttonTypesB = [];
  var checkStateF  = [];  var checkStateM  = [];  var checkStateMB = [];
  var queryString1 = [];  var queryString2 = [];  var queryString3 = [];  var queryString4 = []; var queryString5;
  
  var picSrc;  var nameVal;

  (function() {
    startSearchingMap();
  })();
  
  function startSearchingMap() {
    getMyFriendsInfo();
    getMyMembers(1);
  
}; // 데이터 로딩 함수 끝

  function getMyInfo() {
    $.getJSON(contextRoot + '/member/getMyLoc.do', {
      mno: sessionStorage.getItem('mno')
    }, function(results) {
      myLoc[0] = parseFloat((results.data[0].latitude));
      myLoc[1] = parseFloat((results.data[0].longitude));
      myLoc[2] = Number(results.data[0].mno);
      myNickname = results.data[0].nickname;
      myIntro = results.data[0].introduction;
      myPhoto = results.data[0].profilePicture;
      mySex = results.data[0].sex;
      myAge = Number(results.data[0].age);
      myHobby = results.data[0].hobby;
      myHometown = results.data[0].hometown;
      /* console.log('initMap() 실행'); */  
      initMap();
    });
  }
  
  function getMyFriendsInfo(mySwitchForModal, picSrcm, nameVal) {
    $.getJSON(contextRoot + '/member/getFriends.do', {
      frdno: sessionStorage.getItem('mno'),
      mno: sessionStorage.getItem('mno')
    }, function(results) {
      if (results.data != 'nothingFound') {
      for (var i = 0; i < results.data.length; i++) {
        var tempArr = [
          results.data[i].nickname,           // 0
          Number(results.data[i].latitude),   // 1
          Number(results.data[i].longitude),  // 2
          results.data[i].introduction,       // 3
          results.data[i].profilePicture,     // 4
          results.distance[i],                // 5
          results.data[i].sex,                // 6
          Number(results.data[i].age),                // 7
          results.data[i].hobby,              // 8
          results.data[i].hometown,           // 9
          results.data[i].mno,                //10
          results.data[i].name                //11
        ];
        friendLocArr.push(tempArr);
        console.log("친구" + i + ": " + friendLocArr[i][0]+"/"+ friendLocArr[i][5]+"/"+ friendLocArr[i][10]);
      }
      }
      if (mySwitchForModal == 1) {
        
        $('.modal-title').text(nameVal+'님과 친구가 되었습니다.');
        $('.addfriend-modal-body2').remove();
        $('.addfriend-modal-body').append('<div class="addfriend-modal-body2"><img class="img-circle addfriend-modal-img" src="'+picSrc+'"></div>');
      }
    });
  }
  
  
  function getMyMembers(mySwitch) {
    $.getJSON(contextRoot + '/member/getMembers.do', {
      mno: sessionStorage.getItem('mno')
    }, function(results) {
      console.log(results.data);
      if (results.data != 'nothingFound') {
      for (var i = 0; i < results.data.length; i++) {
        var tempArr = [
          results.data[i].nickname,
          Number(results.data[i].latitude),
          Number(results.data[i].longitude),
          results.data[i].introduction,
          results.data[i].profilePicture,
          results.distance[i],
          Number(results.data[i].mno),
          results.data[i].sex,
          Number(results.data[i].age),
          results.data[i].hobby,
          results.data[i].hometown,
          results.data[i].name
        ];
        notFriendLocArr.push(tempArr);
        /* console.log("주변회원" + i + ": " + notFriendLocArr[i][0]+"/"+
                    notFriendLocArr[i][5]+"/"+notFriendLocArr[i][6]);    */     
      }
        for (var i = 0; i < notFriendLocArr.length; i++){
          checkRelationMembers(i, mySwitch); 
      }
      } else {
        getMyInfo();
      }
    })
  }
  
  function checkRelationMembers(i, mySwitch) {
    $.getJSON(contextRoot + '/frd/checkRelationMembers.do', {
      mno: sessionStorage.getItem('mno'),
      frdmno: notFriendLocArr[i][6]
    }, function(results) {
      var mno = sessionStorage.getItem('mno');
      var frdmno = notFriendLocArr[i][6];
//          console.log("frdmno: " + notFriendLocArr[i][6]);
      if (results.data != 0) {
        checkStateM[i] = results.data.state;
        checkStateMB[i] = results.data.state;
        console.log("checkStateM" + notFriendLocArr[i][6] + "(" + sessionStorage.getItem("mno") + "-" + notFriendLocArr[i][0] +"["+ notFriendLocArr[i][6]+ "]): " + checkStateM[i]);
      } else {
        checkStateM[i] = 0;
        checkStateMB[i] = 0;
        console.log("checkStateM" + notFriendLocArr[i][6] + "(" + sessionStorage.getItem("mno") + "-" + notFriendLocArr[i][0] +"["+ notFriendLocArr[i][6]+ "]): " + checkStateM[i]);
      }
      assignButton(i, frdmno);
      assignButtonBlock(i, frdmno);
      friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
      if ((mySwitch == 1) && (i == notFriendLocArr.length - 1)) {
        getMyInfo();
      }
      });
  }
  
  function assignButton(i, frdmno) {
    if (checkStateM[i] == 0) {
       buttonTypes[i] = '<input type="button" class="btn btn-custom btn-xs nohover addfriend-btn addfriend-btn-add" mno-data = "' + frdmno +'" value="친구추가">';
    }
    if (checkStateM[i] == 1) {
       buttonTypes[i] = '<input type="button" class="btn btn-custom-white btn-xs addfriend-btn addfriend-btn-adding" mno-data = "' + frdmno +'" value="요청중">';
    }
    if (checkStateM[i] == 3) { 
       buttonTypes[i] = '<a data-toggle="modal" href="#addfriendModal"><input type="button" class="btn btn-custom-green btn-xs addfriend-btn addfriend-btn-accepting" mno-data = "' + frdmno +'" value="수락하기"></a>';
    }
  }
  
  function assignButtonBlock(i, frdmno) {
    if (checkStateMB[i] == 0) {
       buttonTypesB[i] = '<input type="button" class="btn btn-custom btn-xs nohover addfriend-btn-block btn-addfriend-popup" mno-data = "' + frdmno +'" value="친구추가">';
    }
    if (checkStateMB[i] == 1) {
       buttonTypesB[i] = '<input type="button" class="btn btn-custom-white btn-xs addfriend-btn-block  addfriend-btn-adding" mno-data = "' + frdmno +'" value="요청중">';
    }
    if (checkStateMB[i] == 3) { 
       buttonTypesB[i] = '<a data-toggle="modal" href="#addfriendModal"><input type="button" class="btn btn-custom-green btn-xs addfriend-btn-block btn-addfriend-popup-accepting" mno-data = "' + frdmno +'" value="수락하기"></a>';
    }
  }

function friendList(i) {
    if (notFriendLocArr[i][9] == myHobby && notFriendLocArr[i][10] == myHometown &&
        notFriendLocArr[i][9] != ""      && notFriendLocArr[i][10] != ""){
      if (notFriendLocArr[i][7] == 1) {
        queryString1.push('<div class="panel myPanel">' +
        '<div class="panel-heading match-heading myPanel-head">' +
        "BestMatch" +
        '</div>' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkMan.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;취미와 고향이 일치합니다.</div>' +          
        '</div>' +
        '</div>');
      } else if (notFriendLocArr[i][7] == 2){
        queryString1.push('<div class="panel myPanel">' +
        '<div class="panel-heading match-heading myPanel-head">' +
        "BestMatch" +
        '</div>' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkWoman.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;취미와 고향이 일치합니다.</div>' +          
        '</div>' +
        '</div>');
      } else {
        queryString1.push('<div class="panel myPanel">' +
        '<div class="panel-heading match-heading myPanel-head">' +
        "BestMatch" +
        '</div>' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/manIcon.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;취미와 고향이 일치합니다.</div>' +          
        '</div>' +
        '</div>');
      }
    }
  if (notFriendLocArr[i][9] == myHobby && notFriendLocArr[i][10] == myHometown &&
      notFriendLocArr[i][9] == ""      && notFriendLocArr[i][10] != ""){
      if (notFriendLocArr[i][7] == 1) {
        queryString3.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkMan.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;고향이 일치합니다.</div>' +
        '</div>' +
        '</div>');
      } else if (notFriendLocArr[i][7] == 2) {
        queryString3.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkWoman.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;고향이 일치합니다.</div>' +
        '</div>' +
        '</div>');
      } else {
        queryString3.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/manIcon.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;고향이 일치합니다.</div>' +
        '</div>' +
        '</div>');
      }
  }
  if (notFriendLocArr[i][9] == myHobby && notFriendLocArr[i][10] == myHometown &&
      notFriendLocArr[i][9] != ""      && notFriendLocArr[i][10] == ""){
      if (notFriendLocArr[i][7] == 1) {
        queryString2.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i+'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkMan.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;취미가 일치합니다.</div>' +  
        '</div>' +
        '</div>');
      } else if (notFriendLocArr[i][7] == 2) {
        queryString2.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i+'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkWoman.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;취미가 일치합니다.</div>' +  
        '</div>' +
        '</div>');
      } else {
        queryString2.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i+'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/manIcon.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;취미가 일치합니다.</div>' +  
        '</div>' +
        '</div>');
      }
  }
  if (notFriendLocArr[i][9] == myHobby && notFriendLocArr[i][10] == myHometown&&
      notFriendLocArr[i][9] == ""      && notFriendLocArr[i][10] == ""){
      if (notFriendLocArr[i][7] == 1) {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkMan.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      } else if (notFriendLocArr[i][7] == 2) {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkWoman.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      } else {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/manIcon.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      }
  }
  if (notFriendLocArr[i][9] != myHobby && notFriendLocArr[i][10] == myHometown
                                       && notFriendLocArr[i][10] == ""){
      if (notFriendLocArr[i][7] == 1) {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkMan.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      } else if (notFriendLocArr[i][7] == 2) {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkWoman.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      } else {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/manIcon.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      }
  }
  if (notFriendLocArr[i][9] != myHobby && notFriendLocArr[i][10] == myHometown
                                       && notFriendLocArr[i][10] != ""){
      if (notFriendLocArr[i][7] == 1) {
        queryString3.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkMan.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;고향이 일치합니다.</div>' + 
        '</div>' +
        '</div>');
      } else if (notFriendLocArr[i][7] == 2) {
        queryString3.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkWoman.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;고향이 일치합니다.</div>' + 
        '</div>' +
        '</div>');
      } else {
        queryString3.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/manIcon.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;고향이 일치합니다.</div>' + 
        '</div>' +
        '</div>');
      }
      
  }
  if (notFriendLocArr[i][9] == myHobby && notFriendLocArr[i][10] != myHometown && 
      notFriendLocArr[i][9] == ""){
      if (notFriendLocArr[i][7] == 1) {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkMan.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      } else if (notFriendLocArr[i][7] == 2) {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkWoman.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      } else {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/manIcon.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      }
  }
  if (notFriendLocArr[i][9] == myHobby && notFriendLocArr[i][10] != myHometown && 
      notFriendLocArr[i][9] != ""){
      if (notFriendLocArr[i][7] == 1) {
        queryString2.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i+'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkMan.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;취미가 일치합니다.</div>' +    
        '</div>' +
        '</div>');
      } else if (notFriendLocArr[i][7] == 2) {
        queryString2.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i+'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkWoman.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;취미가 일치합니다.</div>' +    
        '</div>' +
        '</div>');
      } else {
        queryString2.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i+'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/manIcon.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div class="panel-member-same"><img class="panel-icon-align" src="images/icons/same.png">&nbsp;취미가 일치합니다.</div>' +    
        '</div>' +
        '</div>');
      }
  }
  
  if (notFriendLocArr[i][9] != myHobby && notFriendLocArr[i][10] != myHometown) {
      if (notFriendLocArr[i][7] == 1) {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkMan.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      } else if (notFriendLocArr[i][7] == 2) {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/checkWoman.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      } else {
        queryString4.push('<div class="panel myPanel">' +
        '<div class="panel-body panel-member-desc">' +
        '<a href=""><img src="' + notFriendLocArr[i][4] +'"id="member'+i +'" class="img-circle match-friendimg"></a>' +
        '<div class="panel-member-name"><img class="panel-icon-align" src="images/icons/manIcon.png">&nbsp;' + notFriendLocArr[i][0] + '</div>' +
        '<div class="panel-member-append"><img class="panel-icon-align" src="images/icons/ruler.png">&nbsp;' + notFriendLocArr[i][5] + "m 이내" + buttonTypes[i] + '</div>' +
        '<div></div>' +          
        '</div>' +
        '</div>');
      }
      
  }
    queryString5 = '<div class="myPanel-none"><div>일치하는 회원이 없습니다.</div><div>조건을 바꿔서 검색해보세요</div></div>';
}
  
  function friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC) {
    $('.myPanel').remove();
    $('.myPanel-none').remove();
    if (sex == 0 && age == 0 && myHobbyC == 0 && myHometownC == 0) { // 1. ABCD = 0
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant) {
          friendList(i);
        }
      }
    }
    if (sex != 0 && age == 0 && myHobbyC == 0 && myHometownC == 0) { // 2.  aBCD = 1
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][7] == sex) {
          friendList(i);
        }
      }
    }
    if (sex == 0 && age != 0 && myHobbyC == 0 && myHometownC == 0) { // 3.  AbCD = 1
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][8] >  ageMin  &&
            notFriendLocArr[i][8] <  ageMax) {
            friendList(i);
        }
      }
    }
    if (sex == 0 && age == 0 && myHobbyC != 0 && myHometownC == 0) { // 4.  ABcD = 1
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][9] == myHobbyC) {
            friendList(i);
        }
      } 
    }
    if (sex == 0 && age == 0 && myHobbyC == 0 && myHometownC != 0) { // 5.  ABCd = 1
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][10] == myHometownC) {
            friendList(i);
        }
      }
    }
    if (sex != 0 && age != 0 && myHobbyC == 0 && myHometownC == 0) { // 6.  abCD = 2
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][7] == sex     &&
            notFriendLocArr[i][8] >  ageMin  &&
            notFriendLocArr[i][8] <  ageMax) {
            friendList(i);
        }
      }
    }
    if (sex == 0 && age != 0 && myHobbyC != 0 && myHometownC == 0) { // 7.  AbcD = 2
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][8] >  ageMin  &&
            notFriendLocArr[i][8] <  ageMax  &&
            notFriendLocArr[i][9] == myHobbyC) {
//            buttonCheck(i);
            friendList(i);
        }
      }
    }
    if (sex == 0 && age == 0 && myHobbyC != 0 && myHometownC != 0) { // 8.  ABcd = 2
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][9]  == myHobbyC    &&
            notFriendLocArr[i][10] == myHometownC) {
            friendList(i);
        }
      }
    }
    if (sex != 0 && age == 0 && myHobbyC == 0 && myHometownC != 0) { // 9.  aBCd = 2
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][7]  == sex        &&
            notFriendLocArr[i][10] == myHometownC) {
            friendList(i);
        }
      }
    }
    if (sex != 0 && age == 0 && myHobbyC != 0 && myHometownC == 0) { // 10.  aBcD = 2
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][7] == sex     &&
            notFriendLocArr[i][9] == myHobbyC) {
            friendList(i);
        }
      }
    }
    if (sex == 0 && age != 0 && myHobbyC == 0 && myHometownC != 0) { // 11.  AbCd = 2
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant &&
            notFriendLocArr[i][8]  >  ageMin  &&
            notFriendLocArr[i][8]  <  ageMax  &&
            notFriendLocArr[i][10] == myHometownC) {
            friendList(i);
        }
      }
    }
    if (sex != 0 && age != 0 && myHobbyC != 0 && myHometownC == 0) { // 12. abcD = 3
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][7] == sex     &&
            notFriendLocArr[i][8] >  ageMin  &&
            notFriendLocArr[i][8] <  ageMax  &&
            notFriendLocArr[i][9] == myHobbyC) {
            friendList(i);
        }
      } 
    }
    if (sex != 0 && age != 0 && myHobbyC == 0 && myHometownC != 0) { // 13. abCd = 3
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant &&
            notFriendLocArr[i][7]  == sex     &&
            notFriendLocArr[i][8]  >  ageMin  &&
            notFriendLocArr[i][8]  <  ageMax  &&
            notFriendLocArr[i][10] == myHometownC) {
            friendList(i);
        }
      }
    }
    if (sex != 0 && age == 0 && myHobbyC != 0 && myHometownC != 0) { // 14. aBcd = 3
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][7]  == sex        &&
            notFriendLocArr[i][9]  == myHobbyC   &&
            notFriendLocArr[i][10] == myHometownC) {
            friendList(i);
        }
      }
    }
    if (sex == 0 && age != 0 && myHobbyC != 0 && myHometownC != 0) { // 15. Abcd = 3
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][8]  >  ageMin     &&
            notFriendLocArr[i][8]  <  ageMax     &&
            notFriendLocArr[i][9]  == myHobbyC   &&
            notFriendLocArr[i][10] == myHometownC) {
            friendList(i);
        }
      }
    }
    if (sex != 0 && age != 0 && myHobbyC != 0 && myHometownC != 0) { // 16. abcd = 4
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][7]  == sex        &&
            notFriendLocArr[i][8]  >  ageMin     &&
            notFriendLocArr[i][8]  <  ageMax     &&
            notFriendLocArr[i][9]  == myHobbyC   &&
            notFriendLocArr[i][10] == myHometownC) {
            friendList(i);
        }
      }
    }
    queryStringSpin();
    if ($('.myPanel').length > 0) {
//      console.log('myPanel이 있네');
    } else {
//      console.log('myPanel이 없네');
      $('.myPanel-none').remove();
      $('.panel-member').append(queryString5);
//      queryString5 = null;
    }
  }      
      
  function queryStringSpin() {
    for (var i = 0; i < queryString1.length; i++) {
      $('.panel-member').append(queryString1[i]);
    }
    for (var i = 0; i < queryString2.length; i++) {
      $('.panel-member').append(queryString2[i]);
    }
    for (var i = 0; i < queryString3.length; i++) {
      $('.panel-member').append(queryString3[i]);
    }
    for (var i = 0; i < queryString4.length; i++) {
      $('.panel-member').append(queryString4[i]);
    }
    queryString1 = [];
    queryString2 = [];
    queryString3 = [];
    queryString4 = [];
  }
    
  
  function initMap() { // 구글맵 초기화 함수.
//    var map; // 맵객체에 필요
    var circle; // 주변 동그라미 그릴 변수
    var myWindow;      var marker;
    var friendWindow = []; /* 친구들 팝업창 */ var friendMarkers = []; /*팝업창 띄울 때의 마커들 */
    var notFriendWindow = []; var notFriendMarkers = [];
    var memberBtn = [];
    var radius = { /* 반경 보여줄 지점 */
      radiusCenter: {
        center: { lat: myLoc[0], lng: myLoc[1] },
        /* 반경의 중심 */
        population: 130 /* 반경 설정 200m: 26, 500m: 65, 1km: 130, 2km: 500*/
      }
    };
    
    // 구글맵을 보여줌
    var map = new google.maps.Map(document.getElementById('mainMap'), {
      zoom: 15,
      /* 처음 화면을 보여주는 위도, 경도 */
      center: { lat: myLoc[0], lng: myLoc[1] },
      disableDefaultUI: true,
      /* DEFAULT UI 사용*/
      panControl: false,
      zoomControl: false,
      scaleControl: false /* 척도 */
    });

    markMyLoc(); // 나의 위치 마킹해줌
    distant = 1000;
    
    
    if (friendLocArr.length == 0 && notFriendLocArr.length == 0) {
      queryString5 = '<div class="myPanel-none"><div>회원님의 친구 또는 주변 회원이 없습니다.</div>'
      console.log(queryString5);
      $('.myPanel-none').remove();
      $('.panel-member').append(queryString5);

    } else {
    }
    
    
    
    
    
    for (var i = 0; i < friendLocArr.length; i++) {
//      console.log(friendLocArr[i])
      if(friendLocArr[i][5] <= distant) {
        markFriends(i,1,1); /* 친구 마킹 */
      } else {
        markFriends(i,0,0);
      }
    }
    for (var i = 0; i < notFriendLocArr.length; i++) {
//      console.log(notFriendLocArr[i]);
      if(notFriendLocArr[i][5] <= distant) {
        markNotFriends(i,1,1); /* 주변 회원 마킹 */
      } else {
        markNotFriends(i,0,0);   
      }
    }
    
    markCircle(); /* 반경 렌더링 */

  function markMyLoc() {
      marker = new google.maps.Marker({
        position: { lat: myLoc[0], lng: myLoc[1] },
        map: map,
        icon: 'images/icons/myHome.png',
        animation: google.maps.Animation.DROP
      });
      myWindow = new google.maps.InfoWindow({ /* 팝업창 생성 */
      content: "<div id='iw-container'>" +
        "<div class='iw-title'>" + myNickname + "</div>" +
        "<div class='iw-content'>" +
        "<div class='iw-subTitle'>" +
        "<img src=" + myPhoto + " class='img-circle iw-img'>" +
        "</div>" +
        "<div class='iw-subTitle'>" +
        "<div class='iw-myIntro'>" +myIntro+ "</div>" +
        "</div>" +
        "</div>" +
        "</div>"
      });
      marker.addListener('click', function() {
        if (marker.getAnimation() == null) {
            marker.setAnimation(google.maps.Animation.BOUNCE);
            myWindow.open(map, marker);
        } else {
            marker.setAnimation(null);
            myWindow.close(map, marker);
        }
      });
      
    google.maps.event.addListener(myWindow, 'domready', function() {
      infoWindowsCSS(); // 팝업창 css 설정해줌
    });
    }

  function markFriends(i, mapAdj, dropAdj) {
      var friendLoc = friendLocArr[i];
      
      if (mapAdj == 0 && dropAdj == 0) {
          friendMarkers.push(new google.maps.Marker({
            title: friendLoc[0],
            position: { lat: friendLoc[1], lng: friendLoc[2] },
            icon: 'images/icons/friendHome.png'
          }));
      }
      if (mapAdj == 1 && dropAdj == 0) {
          friendMarkers.push(new google.maps.Marker({
            title: friendLoc[0],
            position: { lat: friendLoc[1], lng: friendLoc[2] },
            map: map,
            icon: 'images/icons/friendHome.png'
          }));
      }
      if (mapAdj == 1 && dropAdj == 1) {
          friendMarkers.push(new google.maps.Marker({
            title: friendLoc[0],
            position: { lat: friendLoc[1], lng: friendLoc[2] },
            map: map,
            animation: google.maps.Animation.DROP,
            icon: 'images/icons/friendHome.png'
          }));
      }
      friendMarkers[i].addListener('click', function() {
        if (friendMarkers[i].getAnimation() == null) {
            friendMarkers[i].setAnimation(google.maps.Animation.BOUNCE);
            friendWindow[i].open(map, friendMarkers[i]);
        } else {
            friendMarkers[i].setAnimation(null);
            friendWindow[i].close(map, friendMarkers[i]);
        }
      });
      friendWindow[i] = new google.maps.InfoWindow({ /* 팝업창 생성 */
        content: "<div id='iw-container'>" +
          "<div class='iw-title thisisfriend'>" + friendLocArr[i][0] + "</div>" +
          "<div class='iw-content'>" +
          "<div class='iw-subTitle'>" +
          "<img src=" + friendLocArr[i][4] + " class='img-circle iw-img'>" +
          "</div>" +
          "<div class='iw-subTitle2'>" + 
          "<table class='iw-myTable'>" +
            "<tr>" +
              "<td class='iw-desc'><img class='iw-desc-img' src='images/icons/manIcon.png'>&nbsp;이름: "+friendLocArr[i][11]+"</td>" +
              "<td class='iw-desc'><img class='iw-desc-img' src='images/icons/age.png'>&nbsp;나이: "+friendLocArr[i][7]+"</td>" +
            "</tr>" +
            "<tr>" +
              "<td class='iw-desc'><img class='iw-desc-img' src='images/icons/hobby.png'>&nbsp;취미: "+friendLocArr[i][8]+"</td>" +
              "<td class='iw-desc'><img class='iw-desc-img' src='images/icons/hometown.png'>&nbsp;고향: "+friendLocArr[i][9]+"</td>" +
            "</tr>" +
          "</table>" +
          "<div class='iw-subTitle'>" +
          "<div class='iw-myIntro'>" + friendLocArr[i][3] + "</div>" +
          "</div>" +
          "</div>" +
          "</div>" +
          "</div>"
        
//        
//        "<div class='iw-title thisisfriend'>" + friendLocArr[i][0] + "</div>" +
//          "<div class='iw-content'>" +
//          "<div class='iw-subTitle'>" +
//          "<img src=" + friendLocArr[i][4] + " class='img-circle iw-img'>" +
//          "</div>" +
//          "<div class='iw-subTitle2'>" + 
//          "<div class='iw-notfriend-desc'><img src='images/icons/manIcon.png'>&nbsp;이름: "+friendLocArr[i][11]+"</div>" +
//          "<div class='iw-notfriend-desc'><img src='images/icons/age.png'>&nbsp;나이: "+friendLocArr[i][8]+"</div>" +
//          "<div class='iw-notfriend-desc'><img src='images/icons/hobby.png'>&nbsp;취미: "+friendLocArr[i][9]+"</div>" +
//          "<div class='iw-notfriend-desc'><img src='images/icons/hometown.png'>&nbsp;고향: "+friendLocArr[i][10]+"</div></div>" +
//          "<div class='iw-subTitle'>" +
//          "<input type='text' class='form-control input-xs' value=" + friendLocArr[i][3] + ">" +
//          "</div>" +
//          "</div>" +
//          "</div>" +
//          "</div>"
        
      });
      google.maps.event.addListener(friendWindow[i], 'domready', function() {
        infoWindowsCSS();// 팝업창 css 설정해줌
      });
//    $(document).on('click', '#mainMap', function(e) {
//       e.stopPropagation();
//       friendMarkers[i].setAnimation(null);
//       friendWindow[i].close(map, friendMarkers[i]);
//      });
    }
        
  function markNotFriends(i, mapAdj, dropAdj) {
      var notFriendLoc = notFriendLocArr[i];   
      
      if (mapAdj == 0 && dropAdj == 0) {
          notFriendMarkers.push(new google.maps.Marker({
            title: notFriendLoc[0],
            position: { lat: notFriendLoc[1], lng: notFriendLoc[2] },
            icon: 'images/icons/pin.png'
          }));
      }
      if (mapAdj == 1 && dropAdj == 0) {
          notFriendMarkers.push(new google.maps.Marker({
            title: notFriendLoc[0],
            position: { lat: notFriendLoc[1], lng: notFriendLoc[2] },
            map: map,
            icon: 'images/icons/pin.png'
        }));
      }
      if (mapAdj == 1 && dropAdj == 1) {
          notFriendMarkers.push(new google.maps.Marker({
            title: notFriendLoc[0],
            position: { lat: notFriendLoc[1], lng: notFriendLoc[2] },
            map: map,
            animation: google.maps.Animation.DROP,
            icon: 'images/icons/pin.png'
        }));
      }
      notFriendWindow[i] = new google.maps.InfoWindow({ /* 팝업창 생성 */
        content: "<div id='iw-container'>" +
          "<div class='iw-title thisismember'>" + notFriendLocArr[i][0] + "</div>" +
          "<div class='iw-content classForSrc'>" +
          "<div class='iw-subTitle'>" +
          "<img src=" + notFriendLocArr[i][4] + " class='img-circle iw-img'>" +
          "</div>" +
          "<div class='iw-subTitle2'>" + 
          "<table class='iw-myTable'>" +
            "<tr>" +
              "<td class='iw-desc'><img class='iw-desc-img' src='images/icons/manIcon.png'>&nbsp;이름: "+notFriendLocArr[i][11]+"</td>" +
              "<td class='iw-desc'><img class='iw-desc-img' src='images/icons/age.png'>&nbsp;나이: "+notFriendLocArr[i][8]+"</td>" +
            "</tr>" +
            "<tr>" +
              "<td class='iw-desc'><img class='iw-desc-img' src='images/icons/hobby.png'>&nbsp;취미: "+notFriendLocArr[i][9]+"</td>" +
              "<td class='iw-desc'><img class='iw-desc-img' src='images/icons/hometown.png'>&nbsp;고향: "+notFriendLocArr[i][10]+"</td>" +
            "</tr>" +
          "</table>" +
          "<div class='iw-subTitle'>" +
          "<div class='iw-myIntro'>"+ notFriendLocArr[i][3] + "</div>" +
          buttonTypesB[i] + 
          "</div>" +
          "</div>" +
          "</div>" +
          "</div>"
      });
//    $(document).on('click', '#mainMap', function(e) {
//         e.stopPropagation();
//        if (notFriendMarkers[i].getAnimation() == null) {
//            notFriendWindow[i].open(map, notFriendMarkers[i]);
//            notFriendMarkers[i].setAnimation(google.maps.Animation.BOUNCE);
//        } else {
//            notFriendMarkers[i].setAnimation(null);
//            notFriendWindow[i].close(map, notFriendMarkers[i]);
//        }
//      console.log('#mainMap click');
//      });
        notFriendMarkers[i].addListener('click', function() {
          if (notFriendMarkers[i].getAnimation() == null) {
            notFriendWindow[i].open(map, notFriendMarkers[i]);
            notFriendMarkers[i].setAnimation(google.maps.Animation.BOUNCE);
        } else {
            notFriendMarkers[i].setAnimation(null);
            notFriendWindow[i].close(map, notFriendMarkers[i]);
        }
          console.log('marker click');
        });
      
      google.maps.event.addListener(notFriendWindow[i], 'domready', function() {
        infoWindowsCSS(i);// 팝업창 css 설정해줌
      });
      
      memberBtn.push('#member' + i);
      $(document).off('click', memberBtn[i]);
//      $(document).off('dbclick', memberBtn[i]);
      $(document).on('click', memberBtn[i], function(e) {  
        e.preventDefault();
        console.log(notFriendMarkers[i]);
        console.log(notFriendWindow[i]);
//        console.log(memberBtn[i]);
        if (notFriendMarkers[i].getAnimation() == null) {
            notFriendWindow[i].open(map, notFriendMarkers[i]);
            notFriendMarkers[i].setAnimation(google.maps.Animation.BOUNCE);
        } else {
            notFriendMarkers[i].setAnimation(null);
            notFriendWindow[i].close(map, notFriendMarkers[i]);
        }
      });
      
    }
  //info 윈도우 CSS 정의
  function infoWindowsCSS(i) {
      var iwOuter = $('.gm-style-iw');
      var iwBackground = iwOuter.prev();
      iwBackground.children(':nth-child(2)').css({
        'display': 'none'
      });
      iwBackground.children(':nth-child(4)').css({
        'display': 'none'
      });
      iwBackground.children(':nth-child(3)').find('div').children().css({
        'box-shadow': 'rgba(72, 181, 233, 0.6) 0px 1px 6px',
        'z-index': '1'
      });
      var iwCloseBtn = iwOuter.next();
      iwCloseBtn.css({
        opacity: '0',
        right: '28px',
        top: '16px',
        border: '0px solid #48b5e9',
        'border-radius': '4px'
      });
      iwCloseBtn.mouseout(function() {
        $(this).css({
          opacity: '0',
          'z-index': '-1'
        });
      });
      iwCloseBtn.mouseover(function() {
        $(this).css({
          opacity: '0',
          'z-index': '-1'
        });
      });
//      iwCloseBtn.on('click', function() {
//        console.log($(this).parent().find('.thisisfriend'));
//        if ($(this).parent().find('.thisisfriend').length) {
//          friendMarkers[i].setAnimation(null);
//        } else {
//          notFriendMarkers[i].setAnimation(null);
//        }
//      }); 나중에 함!
    }
    
  function markCircle() {
    for (var city in radius) {
      circle = new google.maps.Circle({
        strokeColor: '#000',
        /* 반경 렌더링 보더 색*/
        strokeOpacity: 0.4,
        strokeWeight: 1,
        fillColor: '#FFFFFF',
        /* 반경 렌더링 채움 색 */
        fillOpacity: 0.25,
        map: map,
        center: radius[city].center,
        radius: Math.sqrt(radius[city].population) * 100
      });
    }
  }
    
  function radiusDistance(m) { /* 반경 렌더링 거리 조정 함수 */
    radius = { /* 반경 보여줄때의 변수 */
      radiusCenter: {
        /* 반경의 중심 */
        center: { lat: myLoc[0], lng: myLoc[1] },
        population: m /* 반경 설정 200m: 4, 500m: 27, 1km: 97 */
      }
    };
    circle.setMap(null);
    markCircle();
  }  
    
  function dropMarkers(distant) {
    for (var i = 0; i < friendLocArr.length; i++) {
      if (friendLocArr[i][5] < distant) {
        markFriends(i,1,1); /* 친구 마킹 */
      } else {
        markFriends(i,0,0);
      }
    }
    for (var i = 0; i < notFriendLocArr.length; i++) {
      if (notFriendLocArr[i][5] < distant) {
        markNotFriends(i,1,1); /* 주변 회원 마킹 */
      } else {
        markNotFriends(i,0,0);
      }
    }
  }
  
  function renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC) {
    if (sex == 0 && age == 0 && myHobbyC == 0 && myHometownC == 0) { // 1. ABCD = 0
      console.log('========================================');
      console.log('CONDITION: None');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i+": " +notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex != 0 && age == 0 && myHobbyC == 0 && myHometownC == 0) { // 2.  aBCD = 1
      console.log('========================================');
      console.log('CONDITION: sex');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][6] == sex) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][7] == sex) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex == 0 && age != 0 && myHobbyC == 0 && myHometownC == 0) { // 3.  AbCD = 1
      console.log('========================================');
      console.log('CONDITION: age');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][7] >  ageMin  &&
            friendLocArr[i][7] <  ageMax){
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][8] >  ageMin  &&
            notFriendLocArr[i][8] <  ageMax) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex == 0 && age == 0 && myHobbyC != 0 && myHometownC == 0) { // 4.  ABcD = 1
      console.log('========================================');
      console.log('CONDITION: hobby');
     for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][8] == myHobbyC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][9] == myHobbyC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      } 
    }
    if (sex == 0 && age == 0 && myHobbyC == 0 && myHometownC != 0) { // 5.  ABCd = 1
      console.log('========================================');
      console.log('CONDITION: hometown');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant    &&
            friendLocArr[i][9] == myHometownC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][10] == myHometownC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex != 0 && age != 0 && myHobbyC == 0 && myHometownC == 0) { // 6.  abCD = 2
      console.log('========================================');
      console.log('CONDITION: sex, age');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][6] == sex     &&
            friendLocArr[i][7] >  ageMin  &&
            friendLocArr[i][7] <  ageMax) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][7] == sex     &&
            notFriendLocArr[i][8] >  ageMin  &&
            notFriendLocArr[i][8] <  ageMax) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex == 0 && age != 0 && myHobbyC != 0 && myHometownC == 0) { // 7.  AbcD = 2
      console.log('========================================');
      console.log('CONDITION: age, hobby');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][7] >  ageMin  &&
            friendLocArr[i][7] <  ageMax  &&
            friendLocArr[i][8] == myHobbyC){
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][8] >  ageMin  &&
            notFriendLocArr[i][8] <  ageMax  &&
            notFriendLocArr[i][9] == myHobbyC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex == 0 && age == 0 && myHobbyC != 0 && myHometownC != 0) { // 8.  ABcd = 2
      console.log('========================================');
      console.log('CONDITION: hobby, hometown');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant    &&
            friendLocArr[i][8] == myHobbyC    &&
            friendLocArr[i][9] == myHometownC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][9]  == myHobbyC    &&
            notFriendLocArr[i][10] == myHometownC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex != 0 && age == 0 && myHobbyC == 0 && myHometownC != 0) { // 9.  aBCd = 2
      console.log('========================================');
      console.log('CONDITION: sex, hometown');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][6] == sex     &&
            friendLocArr[i][9] == myHometownC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][7]  == sex        &&
            notFriendLocArr[i][10] == myHometownC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex != 0 && age == 0 && myHobbyC != 0 && myHometownC == 0) { // 10.  aBcD = 2
      console.log('========================================');
      console.log('CONDITION: sex, hobby');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][6] == sex     &&
            friendLocArr[i][8] == myHobbyC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][7] == sex     &&
            notFriendLocArr[i][9] == myHobbyC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex == 0 && age != 0 && myHobbyC == 0 && myHometownC != 0) { // 11.  AbCd = 2
      console.log('========================================');
      console.log('CONDITION: age, hometown');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][7] >  ageMin  &&
            friendLocArr[i][7] <  ageMax  &&
            friendLocArr[i][9] == myHometownC){
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant &&
            notFriendLocArr[i][8]  >  ageMin  &&
            notFriendLocArr[i][8]  <  ageMax  &&
            notFriendLocArr[i][10] == myHometownC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex != 0 && age != 0 && myHobbyC != 0 && myHometownC == 0) { // 12. abcD = 3
      console.log('========================================');
      console.log('CONDITION: sex, age, hobby');
     for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][6] == sex     &&
            friendLocArr[i][7] >  ageMin  &&
            friendLocArr[i][7] <  ageMax  &&
            friendLocArr[i][8] == myHobbyC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5] <  distant &&
            notFriendLocArr[i][7] == sex     &&
            notFriendLocArr[i][8] >  ageMin  &&
            notFriendLocArr[i][8] <  ageMax  &&
            notFriendLocArr[i][9] == myHobbyC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      } 
    }
    if (sex != 0 && age != 0 && myHobbyC == 0 && myHometownC != 0) { // 13. abCd = 3
      console.log('========================================');
      console.log('CONDITION: sex, age, hometowns');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant &&
            friendLocArr[i][6] == sex     &&
            friendLocArr[i][7] >  ageMin  &&
            friendLocArr[i][7] <  ageMax  &&
            friendLocArr[i][9] == myHometownC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant &&
            notFriendLocArr[i][7]  == sex     &&
            notFriendLocArr[i][8]  >  ageMin  &&
            notFriendLocArr[i][8]  <  ageMax  &&
            notFriendLocArr[i][10] == myHometownC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex != 0 && age == 0 && myHobbyC != 0 && myHometownC != 0) { // 14. aBcd = 3
      console.log('========================================');
      console.log('CONDITION: sex, hobby, hometown');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant    &&
            friendLocArr[i][6] == sex        &&
            friendLocArr[i][8] == myHobbyC   &&
            friendLocArr[i][9] == myHometownC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][7]  == sex        &&
            notFriendLocArr[i][9]  == myHobbyC   &&
            notFriendLocArr[i][10] == myHometownC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex == 0 && age != 0 && myHobbyC != 0 && myHometownC != 0) { // 15. Abcd = 3
      console.log('========================================');
      console.log('CONDITION: age, hobby, hometown');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant    &&
            friendLocArr[i][7] >  ageMin     &&
            friendLocArr[i][7] <  ageMax     &&
            friendLocArr[i][8] == myHobbyC   &&
            friendLocArr[i][9] == myHometownC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][8]  >  ageMin     &&
            notFriendLocArr[i][8]  <  ageMax     &&
            notFriendLocArr[i][9]  == myHobbyC   &&
            notFriendLocArr[i][10] == myHometownC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
    if (sex != 0 && age != 0 && myHobbyC != 0 && myHometownC != 0) { // 16. abcd = 4
      console.log('========================================');
      console.log('CONDITION: sex, age, hobby, hometown');
      for (var i = 0; i < friendLocArr.length; i++) {
        if (friendLocArr[i][5] <  distant    &&
            friendLocArr[i][6] == sex        &&
            friendLocArr[i][7] >  ageMin     &&
            friendLocArr[i][7] <  ageMax     &&
            friendLocArr[i][8] == myHobbyC   &&
            friendLocArr[i][9] == myHometownC) {
          markFriends(i,1,0);
          console.log('#친구'+ i +": "+friendLocArr[i][0]);
        } else {
          markFriends(i,0,0);
        }
      }
      for (var i = 0; i < notFriendLocArr.length; i++) {
        if (notFriendLocArr[i][5]  <  distant    &&
            notFriendLocArr[i][7]  == sex        &&
            notFriendLocArr[i][8]  >  ageMin     &&
            notFriendLocArr[i][8]  <  ageMax     &&
            notFriendLocArr[i][9]  == myHobbyC   &&
            notFriendLocArr[i][10] == myHometownC) {
          markNotFriends(i,1,0);
          console.log('*멤버'+ i +": "+notFriendLocArr[i][0]);
        } else {
          markNotFriends(i,0,0);
        }
      }
    }
  }
    
  // 거리 설정 후 마킹하기전 맵의 마커들을 없애주는 함수
  function clearMarkers() {
    for (var i = 0; i < friendMarkers.length; i++) {
      friendMarkers[i].setMap(null);
    }
    for (var i = 0; i < notFriendMarkers.length; i++) {
      notFriendMarkers[i].setMap(null);
    }
    friendMarkers = [];
    notFriendMarkers = [];
  }
    
  function checkArray() {
    for (var i = 0; i < friendLocArr.length; i++){
      console.log("#" + i + "/" + friendLocArr[i][0]+"/"+ friendLocArr[i][10]);
    }
    for (var i = 0; i < notFriendLocArr.length; i++){
      console.log("*" + i + "/" + notFriendLocArr[i][0]+"/"+ notFriendLocArr[i][6]);
    }
  }
    
  // 500m 버튼  
  $(document).on('click','.radius-500', function() {
    if (!($('.radius-500').hasClass('active'))) {
      distant = 500;
      clearMarkers();
      radiusDistance(27);
      dropMarkers(distant);
      friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
    }
  });
  // 1000m 버튼
  $(document).on('click','.radius-1000', function() {
    if (!($('.radius-1000').hasClass('active'))) {
      distant = 1000;
      clearMarkers();
      radiusDistance(97);
      dropMarkers(distant);
      friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
    }
  });
  // 2000m 버튼  
  $(document).on('click','.radius-2000', function() {
    if (!($('.radius-2000').hasClass('active'))) {
      distant = 2000;
      clearMarkers();
      radiusDistance(500);
      dropMarkers(distant);
      friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
    }
  });
  
  // 남녀 모두 버튼   
  $(document).on('click', '.btn-manwoman', function() {
    if ($('#age').val() && $('#hobby').val() && $('#hometown').val()) {
      if (!($('.btn-manwoman').hasClass('active'))) {
        sex = 0;
        clearMarkers();
        renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        console.log('PARAMETER: distant(' + distant + ')/sex(' + sex + ')/age(' + age + ')/ageMin(' + ageMin + ')/ageMax(' + ageMax + ')/myHobbyC(' + myHobbyC + ')/myHometownC(' + myHometownC + ')');
        console.log('========================================');  
      }
    } else {
      $('#untouchButtonModal').modal();
    }
  });
  // 남자 버튼
  $(document).on('click', '.btn-man', function() {
    console.log($('#hobby').val());
    if ($('#age').val() && $('#hobby').val() && $('#hometown').val()) {
      if (!($('.btn-man').hasClass('active'))) {
      sex = 1;
      clearMarkers();
      renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
      friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
      console.log('PARAMETER: distant(' + distant + ')/sex(' + sex + ')/age(' + age + ')/ageMin(' + ageMin + ')/ageMax(' + ageMax + ')/myHobbyC(' + myHobbyC + ')/myHometownC(' + myHometownC + ')');
      console.log('========================================');
      }
    } else {
      $('#untouchButtonModal').modal();
    }
  });
  // 여자 버튼
  $(document).on('click', '.btn-woman', function() {
    if ($('#age').val() && $('#hobby').val() && $('#hometown').val()) {
      if (!($('.btn-woman').hasClass('active'))) {
        sex = 2;  
        clearMarkers();
        renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        console.log('PARAMETER: distant(' + distant + ')/sex(' + sex + ')/age(' + age + ')/ageMin(' + ageMin + ')/ageMax(' + ageMax + ')/myHobbyC(' + myHobbyC + ')/myHometownC(' + myHometownC + ')');
        console.log('========================================');  
      }
    } else {
      $('#untouchButtonModal').modal();
    }
  });
    
  // 나이 버튼
  $(document).on('click', '.btn-age', function() {
    if ($('#age').val() && $('#hobby').val() && $('#hometown').val()) {
      if (!($('.btn-age').hasClass('active'))) {
        age = 1;
        ageMin = myAge - 5;
        ageMax = myAge + 5;
        clearMarkers();
        renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        console.log('PARAMETER: distant(' + distant + ')/sex(' + sex + ')/age(' + age + ')/ageMin(' + ageMin + ')/ageMax(' + ageMax + ')/myHobbyC(' + myHobbyC + ')/myHometownC(' + myHometownC + ')');
        console.log('========================================');
      } else {
        age = 0;
        ageMin = 0;
        ageMax = 0;
        clearMarkers();
        renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
      }
    } else {
      $('#untouchButtonModal').modal();
    }
      
  });
  // 취미 버튼
  $(document).on('click', '.btn-hobby', function() {
    if ($('#age').val() && $('#hobby').val() && $('#hometown').val()) {
      if (!($('.btn-hobby').hasClass('active'))) {
        myHobbyC = myHobby;
        clearMarkers();
        renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        console.log('PARAMETER: distant(' + distant + ')/sex(' + sex + ')/age(' + age + ')/ageMin(' + ageMin + ')/ageMax(' + ageMax + ')/myHobbyC(' + myHobbyC + ')/myHometownC(' + myHometownC + ')');
        console.log('========================================');
      } else {
        myHobbyC = 0;
        clearMarkers();
        renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
      }  
    } else {
       $('#untouchButtonModal').modal();
    }
    
  });  
    

    
    
    
  // 고향 버튼
  $(document).on('click', '.btnHometown', function() {
    if ($('#age').val() && $('#hobby').val() && $('#hometown').val()) {
      if (!($('.btn-hometown').hasClass('active'))) {
        myHometownC = myHometown; 
        clearMarkers();
        renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);   
        console.log('PARAMETER: distant(' + distant + ')/sex(' + sex + ')/age(' + age + ')/ageMin(' + ageMin + ')/ageMax(' + ageMax + ')/myHobbyC(' + myHobbyC + ')/myHometownC(' + myHometownC + ')');
        console.log('========================================');
      } else { 
        myHometownC = 0;
        clearMarkers();
        renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
      }  
    } else {
        $('#untouchButtonModal').modal();
    }
  });
    
    
  
  // popup창에서  '친구추가' 버튼
  $(document).on('click', '.btn-addfriend-popup', function(event) {
    event.preventDefault();
      var parent = this;
    $.ajax(contextRoot + '/frd/insert.do', {
        method: 'post',
        dataType: 'json',
        data: {
            frdmno: $(parent).attr('mno-data'),
            mno: sessionStorage.getItem('mno')
        },
      success: function(result) {
        var frdmno = $(parent).attr('mno-data');
        $(parent).hide();
        checkStateM[frdmno] = 1;
        checkStateMB[frdmno] = 1;
        console.log("checkStateM[" + frdmno + "]: " + checkStateM[frdmno]);
        $(parent).closest('.iw-subTitle2').append('<input type="button" class="btn btn-default btn-xs btn-block addfriend-btn-adding" mno-data = "' + frdmno +'" value="요청중">');
        
        for (var i = 0; i < notFriendLocArr.length; i++) {
          (function(i) {
            $.getJSON(contextRoot + '/frd/checkRelationMembers.do', {
              mno: sessionStorage.getItem('mno'),
              frdmno: notFriendLocArr[i][6]
            }, function(results) {
              if (results.data != 0) {
                checkStateM[i] = results.data.state;
                checkStateMB[i] = results.data.state;
              } else {
                checkStateM[i] = 0;
                checkStateMB[i] = 0;
              }
              console.log('assignButton();');
              assignButton(i, notFriendLocArr[i][6]);
              assignButtonBlock(i, notFriendLocArr[i][6]);
              console.log('friendListCreater();');
              friendListCreater(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
              console.log(notFriendLocArr.length);
              if (i == (notFriendLocArr.length - 1)) {
                clearMarkers();
                renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
              }
            });
          })(i);
        }
        
      }
      });
  });
  // popup에서 '수락하기' 버튼
  $(document).on('click', '.btn-addfriend-popup-accepting', function() {
      var parent = this;
    $.ajax(contextRoot + '/frd/apply.do', {
        method: 'post',
        dataType: 'json',
        data: {
            frdmno: $(parent).attr('mno-data'),
            mno: sessionStorage.getItem('mno')
        },
      success: function() {
        var mno = sessionStorage.getItem('mno');
        var frdmno = $(parent).attr('mno-data');
        picSrc = $(parent).closest('.classForSrc').find('img').attr('src');
        nameVal = $(parent).closest('#iw-container').find('.thisismember').text();
        console.log('nameVal: ' + nameVal);
        
        $(parent).closest('.myPanel').remove();
        checkStateM[frdmno] = 2;
        checkStateMB[frdmno] = 2;
        
        friendLocArr = [];
        notFriendLocArr = [];
        
        getMyFriendsInfo(1, picSrc, nameVal);
        getMyMembers();
        
        $(document).on('click', '#addfriendModal', function() {
          console.log('clearMarkers();');
          clearMarkers();
          console.log('renderMarkers();');
          renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        });    
        } // callback 함수 끝
      })
    });
    
  var check=0;
  // friendbox에서 '친구추가' 버튼
  $(document).on('click', '.addfriend-btn-add', function() {
    var parent = this;
    console.log('여기야!!!!');
    if ( check == 0) {
    $.ajax(contextRoot + '/frd/insert.do', {
        method: 'post',
        dataType: 'json',
        data: {
            frdmno: $(parent).attr('mno-data'),
            mno: sessionStorage.getItem('mno')
        },
      success: function(result) {
        check=1;
        var mno = sessionStorage.getItem('mno');
        var frdmno = $(parent).attr('mno-data');
        $(parent).hide();
        checkStateM[frdmno] = 1;
        checkStateMB[frdmno] = 1;
        console.log("checkStateM[" + frdmno + "]: " + checkStateM[frdmno]);
        $(parent).closest('.panel-member-append').append('<input type="button" class="btn btn-custom-white btn-xs addfriend-btn addfriend-btn-adding" mno-data = "' + frdmno +'" value="요청중">');
        
        for (var i = 0; i < notFriendLocArr.length; i++) {
          (function(i) {
            $.getJSON(contextRoot + '/frd/checkRelationMembers.do', {
              mno: sessionStorage.getItem('mno'),
              frdmno: notFriendLocArr[i][6]
            }, function(results) {
              if (results.data != 0) {
                checkStateM[i] = results.data.state;
                checkStateMB[i] = results.data.state;
              } else {
                checkStateM[i] = 0;
                checkStateMB[i] = 0;
              }
              assignButton(i, notFriendLocArr[i][6]);
              assignButtonBlock(i, notFriendLocArr[i][6]);
              if (i == (notFriendLocArr.length - 1)) {
                clearMarkers();
                renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
              }
            });
          })(i);
        }
       }
      })
    }
    check=0;
  });
  
  // friendbox에서 '수락하기' 버튼
  $(document).on('click', '.addfriend-btn-accepting', function() {
      var parent = this;
    $.ajax(contextRoot + '/frd/apply.do', {
        method: 'post',
        dataType: 'json',
        data: {
            frdmno: $(parent).attr('mno-data'),
            mno: sessionStorage.getItem('mno')
        },
      success: function() {
        var mno = sessionStorage.getItem('mno');
        var frdmno = $(parent).attr('mno-data');
        picSrc = $(parent).closest('.panel-member-desc').find('.match-friendimg').attr('src');
        nameVal = $(parent).closest('.panel-member-desc').find('.panel-member-name').text();
        console.log('nameVal: ' + nameVal);
        
        $(parent).closest('.myPanel').remove();
        checkStateM[frdmno] = 2;
        checkStateMB[frdmno] = 2;
        
        friendLocArr = [];
        notFriendLocArr = [];
        
        getMyFriendsInfo(1, picSrc, nameVal);
        getMyMembers();
        
        $(document).on('click', '#addfriendModal', function() {
          console.log('clearMarkers();');
          clearMarkers();
          console.log('renderMarkers();');
          renderMarkers(distant, sex, age, ageMin, ageMax, myHobbyC, myHometownC);
        });    
        
        } // callback 함수 끝
      })
    });
    
    
  } // initMap 끝 
  
</script>