<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.bit.java72.dao.FeedDao">
  <resultMap type="Feed" id="FeedMap">
    <id     column="fno"      property="fno" />
    <result column="categry"    property="category" />
    <result column="contnt"      property="content" />
    <result column="cre_dt"   property="createDate" />
    <result column="max_headcnt" property="maxHeadCount"/>
    <result column="cnt" property="stuffCount"/>
    <result column="meet_time" property="meetTime"/>
  </resultMap>
  
  <resultMap type="FriendFeed" id="FriendFeedMap">
    <id     column="fno"      property="fno" />
    <result column="categry"    property="category" />
    <result column="contnt"      property="content" />
    <result column="cre_dt"   property="createDate" />
    <result column="max_headcnt" property="maxHeadCount"/>
    <result column="cnt" property="stuffCount"/>
    <result column="meet_time" property="meetTime"/>
    <result column="nicknm"    property="nickname" />
    <result column="pwd"      property="password" />
    <result column="hometwn" property="hometown"/>
    <result column="lat" property="latitude"/>
    <result column="lon" property="longitude"/>
    <result column="addr" property="address"/>
    <result column="mphoto" property="profilePicture"/>
  </resultMap>
 

  <select id="list" resultMap="FriendFeedMap" parameterType="int">
  select 
   t1.NAME,
   t1.MPHOTO,
   t2.CATEGRY,
   t2.MAX_HEADCNT,
   t2.CNT,
   t2.MEET_TIME,
   t2.CONTNT,
   t2.cre_dt,
   t2.TITLE
   from memb_t t1 left outer join feed_t t2 
   on t1.mno=t2.mno
   where t2.categry is not null and t1.mno IN (select frdno from frd_t where mno=#{values} and state=2)
   ORDER by t2.cre_dt desc;
  </select>
  
  <select id="noneFriendFeed" resultMap="FriendFeedMap" parameterType="int">
  select 
   t1.NAME,
   t1.MPHOTO,
   t2.CATEGRY,
   t2.MAX_HEADCNT,
   t2.CNT,
   t2.MEET_TIME,
   t2.CONTNT,
   t2.cre_dt,
   t2.TITLE
   from memb_t t1 left outer join feed_t t2
   on t1.mno=t2.mno
   where t2.categry is not null and t1.mno=#{values}
  </select>
  
 <!-- 내정보 에서 밑에 게시물 출력 -->
   <select id="myActivityList" resultMap="FeedMap">
  select * from feed_t 
  ORDER by cre_dt desc;
  </select>
 

<sql id="search">
		<if test="searchType != null">
			<if test="searchType == 'all'.toString()">
				and( btitle like concat( '%', #{keyword}, '%' )
				or bcontent like concat( '%', #{keyword}, '%' ) 
				or nickname	like concat( '%',#{keyword}, '%' ) 
				or email like concat( '%',#{keyword}, '%' ))
			</if>
			<if test="searchType == 'btitle'.toString()">
				and btitle like concat( '%', #{keyword}, '%' )
			</if>
			<if test="searchType == 'bcontent'.toString()">
				and bcontent like concat( '%', #{keyword}, '%' )
			</if>
			<if test="searchType == 'nickname'.toString()">
				and nickname like concat( '%', #{keyword}, '%' )
			</if>
			<if test="searchType == 'email'.toString()">
				and email like concat( '%', #{keyword}, '%' )
			</if>
		</if>
</sql>
</mapper>

















