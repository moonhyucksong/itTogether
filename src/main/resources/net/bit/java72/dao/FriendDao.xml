<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.bit.java72.dao.FriendDao">
  <resultMap type="FriendList" id="FListMap">
    <id     column="FRDNO" property="frdmno"/>
    <id		column="MNO"     property="mno"/>
    <result column="STATE"     property="state"/>
    <result column="FRD_DT"   property="friendDate"/>
  </resultMap>

  <select id="frdList" parameterType="Int" resultType="int">
    SELECT *
    FROM FRD_T
    WHERE mno=#{values} and state=2
  </select>
  
  
  <select id="applyList" parameterType="Int" resultType="int">
    SELECT *
    FROM FRD_T
    WHERE mno=#{values} and state=1
  </select>
    
  <select id="applyList2" parameterType="Int" resultType="int">
    SELECT *
    FROM FRD_T
    WHERE mno=#{values} and state=3
  </select>
  	
  <select id="getFRD" parameterType="int">
  	SELECT * 
  	FROM memb_t
  	where mno=#{values}
  </select>
  
  <insert id="addFRD" parameterType="FriendList">
    INSERT INTO FRD_T(mno, frdno, state, frd_dt) 
    VALUES(#{mno}, #{frdno},1, now())
  </insert>
  
  <update id="acceptFRD" parameterType="FriendList">
  UPDATE frd_t set state=2 where mno=#{mno} and frdno=#{frdmno} 
  </update>
  
  <delete id="deleteFRD" parameterType="FriendList">
  DELETE from FRD_T where mno=#{mno} and frdno=#{frdmno}
  </delete>
	<sql id="search">
		<if test="searchType != null">
			<if test="searchType == 'all'.toString()">
				and( btitle like concat( '%', #{keyword}, '%' )
				or bcontent like concat( '%', #{keyword}, '%' ) 
				or nickname	like concat( '%',#{keyword}, '%' ) 
				or email like concat( '%',#{keyword}, '%' ))
			</if>
			<if test="searchType == 'btitle'.toString()">
				and btitle like concat( '%', #{keyword}, '%' )
			</if>
			<if test="searchType == 'bcontent'.toString()">
				and bcontent like concat( '%', #{keyword}, '%' )
			</if>
			<if test="searchType == 'nickname'.toString()">
				and nickname like concat( '%', #{keyword}, '%' )
			</if>
			<if test="searchType == 'email'.toString()">
				and email like concat( '%', #{keyword}, '%' )
			</if>
		</if>
	</sql>
</mapper>















